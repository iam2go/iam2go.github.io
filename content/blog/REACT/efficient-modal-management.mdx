---
title: íš¨ìœ¨ì ìœ¼ë¡œ ëª¨ë‹¬ ê´€ë¦¬í•˜ê¸°
date: "2022-10-12"
tags: [react, modal]
description:  context API, Reduxë¥¼ ì‚¬ìš©í•˜ì—¬ ì „ì—­ìœ¼ë¡œ ëª¨ë‹¬ ê´€ë¦¬í•˜ê¸°
thumbnail: "./images/modal.png"
---

ì´ ê¸€ì€ [**Portalì„ ì‚¬ìš©í•œ ëª¨ë‹¬ì°½ ë§Œë“¤ê¸°**](https://iam2go.github.io/REACT/create-modal-using-portal/)ì—ì„œ ì´ì–´ì§‘ë‹ˆë‹¤.

<br/>
<br/>

ëª¨ë‹¬ì„ í•„ìš”í•œ ì»´í¬ë„ŒíŠ¸ì—ì„œ ê·¸ë•Œê·¸ë•Œ ë Œë”ë§ í•˜ëŠ” ë°©ë²•ì€ ë¶ˆí•„ìš”í•œ ì½”ë“œë¥¼ ëŠ˜ë¦¬ë©°, ê°ê°ì˜ ì»´í¬ë„ŒíŠ¸ì—ì„œ ëª¨ë‹¬ì— ê´€ë ¨ëœ ë¡œì§ê¹Œì§€ ë‹´ë‹¹í•˜ê²Œ ë˜ì–´ ì»´í¬ë„ŒíŠ¸ì˜ ë‹¨ì¼ ì±…ì„ ì›ì¹™ì„ ìœ„ë°˜í•œë‹¤.
ëª¨ë‹¬ì˜ ìƒíƒœë¥¼ ì „ì—­ìœ¼ë¡œ ê´€ë¦¬í•˜ì—¬ í•„ìš”í•œ ê³³ì—ì„œ í˜¸ì¶œë§Œ í•´ì£¼ë©´ ë˜ë„ë¡ ë³€ê²½í•œë‹¤ë©´ ìœ„ì—ì„œ ì–¸ê¸‰í•œ ë¬¸ì œì ë“¤ì„ í•´ê²°í•  ìˆ˜ ìˆë‹¤.

ë¨¼ì € context APIë¥¼ ì‚¬ìš©í•œ ë°©ë²•, ê·¸ë¦¬ê³  Reduxë¥¼ ì‚¬ìš©í•œ ë°©ë²•ì— ëŒ€í•´ì„œ ì°¨ë¡€ëŒ€ë¡œ ì•Œì•„ë³´ì.

<br/>
<br/>
# 1ï¸âƒ£ context APIë¥¼ ì‚¬ìš©í•œ ëª¨ë‹¬ ê´€ë¦¬

```
// context/ModalProvider.js

import React, { useState } from "react";

export const ModalStateContext = React.createContext();
export const ModalSetterContext = React.createContext();

function ModalProvider({ children }) {
  const [state, setState] = useState({
            type: null,
            props: null,
    });

  return (
    <ModalSetterContext.Provider value={setState}>
      <ModalStateContext.Provider value={state}>
        {children}
      </ModalStateContext.Provider>
    </ModalSetterhContext.Provider>
  );
}

export default ModalProvider;
```

`createContext()`ë¥¼ í†µí•´ ëª¨ë‹¬ contextë¥¼ ìƒì„±í•´ì¤€ë‹¤.

contextë¥¼ êµ¬ë…í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ëŠ” Providerì˜ value propê°€ ë°”ë€” ë•Œë§ˆë‹¤ ë‹¤ì‹œ ë Œë”ë§ ë˜ê¸° ë•Œë¬¸ì—, setterí•¨ìˆ˜ë§Œ ì´ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ë„ stateê°’ì´ ë°”ë€Œë©´ ë¦¬ë Œë”ë§ ëœë‹¤. ë”°ë¼ì„œ stateì™€ setterí•¨ìˆ˜ ê°ê°ì˜ contextë¥¼ ë¶„ë¦¬í•˜ì—¬ ë¶ˆí•„ìš”í•œ ë¦¬ë Œë”ë§ì„ ë°©ì§€í•˜ì˜€ë‹¤.

```
// index.js

import React from "react";
import ReactDOM from "react-dom/client";
import App from "./App";
import ModalProvider from "./context/ModalProvider";
import GlobalStyle from "./style/GlobalStyle";
const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <>
    <ModalProvider>
      <GlobalStyle />
      <App />
    </ModalProvider>
  </>
);
```

ë§Œë“  `ModalProvider`ë¡œ Appì„ ê°ì‹¸ì¤€ë‹¤.

```
// hooks/useModal.js

import { useContext } from "react";
import { ModalSetterContext } from "../context/ModalProvider";

function useModal() {
  const setModalState = useContext(ModalSetterSContext);

  const openModal = ({ type, props = null }) => {
    setModalState({type, props});
  };

  const closeModal = () => {
    setModalState({type: null, props: null});
  };

  return { openModal, closeModal };
}

export default useModal;
```


<br/>
ì´ì œ contextë¥¼ í†µí•´ ì œê³µë°›ì€ setterí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª¨ë‹¬ì„ ì—´ê³  ë‹«ëŠ” ë¡œì§ì„ êµ¬í˜„í•´ì•¼í•œë‹¤.

`useModal`ì´ë¼ëŠ” ì´ë¦„ì˜ ì»¤ìŠ¤í…€ hookì„ ë§Œë“¤ì–´ì£¼ì—ˆë‹¤.

```
function App() {
  const { openModal } = useModal();

  const onClickButton1 = () => {
    openModal({ type: "first" });
  };

  const onClickButton2 = () => {
    openModal({ type: "second" });
  };

  return (
    <AppWrap>
      <Button onClick={onClickButton1}>Click Me !</Button>
      <Button className="blue" onClick={onClickButton2}>
        Click Me !
      </Button>
        </AppWrap>
    );
}
```

`useModal`ì—ì„œ êµ¬í˜„í•œ `openModal`ì„ ì‚¬ìš©í•˜ì—¬ ëª¨ë‹¬ì„ ë„ìš°ë©´ ëœë‹¤.

<br/>

ë§ˆì§€ë§‰ìœ¼ë¡œ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ ë Œë”ë§ì„ ë‹´ë‹¹í•˜ëŠ” ëª¨ë‹¬ ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë§Œë“¤ì–´ì•¼ í•œë‹¤.

```
// components/ModalContainer.js

import React, { useContext } from "react";
import { createPortal } from "react-dom";
import { ModalStateContext } from "../../context/ModalProvider";
import SampleModal from "./SampleModal";
import SecondModal from "./SecondModal";

const MODAL_COMPONENTS = {
  first: SampleModal,
  second: SecondModal,
};

function ModalContainer() {
  const { type, props } = useContext(ModalStateContext);
    const { }

  if (!type) {
    return null;
  }

  const Modal = MODAL_COMPONENTS[type];
  return createPortal(
    <>
      <Modal {...props} />
    </>,
    document.getElementById("modal")
  );
}

export default ModalContainer;
```

í”„ë¡œì íŠ¸ì—ì„œ ì‚¬ìš©í•˜ëŠ” ëª¨ë“  ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë¶ˆëŸ¬ì˜¨ ë’¤ `MODAL_COMPONENTS`ê°ì²´ì— ì°¨ê³¡ì°¨ê³¡ ë‹´ì•„ì¤€ë‹¤.

contextë¡œë¶€í„° ì „ë‹¬ë°›ì€ typeì— í•´ë‹¹í•˜ëŠ” ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§ í•˜ê³ , propsê°’ì„ ë„˜ê²¨ì¤€ë‹¤.

<br/>


```
// components/ModalContainer
...
import useModal from "../../hooks/useModal";

...
function ModalContainer() {
  const { closeModal } = useModal();

  const renderModal = modalList.map(({ type, props }) => {
    const ModalComponent = MODAL_COMPONENTS[type];
    return <ModalComponent key={type} {...props} onClose={closeModal} />;
  });
  return createPortal(<>{renderModal}</>, document.getElementById("modal"));
}

export default ModalContainer;
```

`closeModal`ë©”ì„œë“œëŠ” ìœ„ ì½”ë“œì²˜ëŸ¼ `ModalContainer`ì—ì„œ ë¶ˆëŸ¬ì™€ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ì˜ propsë¡œ ë„˜ê²¨ì£¼ì–´ë„ ë˜ê³ , ê°ê°ì˜ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ë¶ˆëŸ¬ì™€ ì‚¬ìš©í•´ë„ ëœë‹¤.

```
// index.js

...

import ModalContainer from "./components/Modal/ModalContainer";

const root = ReactDOM.createRoot(document.getElementById("root"));
root.render(
  <>
    <ModalProvider>
      <GlobalStyle />
      <App />
      <ModalContainer />
    </ModalProvider>
  </>
);
```

ì´ ëª¨ë‹¬ ê´€ë¦¬ ì»´í¬ë„ŒíŠ¸ëŠ” Appê³¼ ê°™ì€ ë ˆë²¨ì— ì¶”ê°€í•´ì£¼ì—ˆë‹¤.


<br/>
<br/>


# 2ï¸âƒ£ reduxë¥¼ ì‚¬ìš©í•œ ëª¨ë‹¬ ê´€ë¦¬

ì •í™•íˆëŠ” **redux-toolkit**ì„ ì‚¬ìš©í•œ ëª¨ë‹¬ ê´€ë¦¬ì— ëŒ€í•˜ì—¬ ì„¤ëª…í•œë‹¤. `ModalContainer`ë¥¼ ë¹„ë¡¯í•œ ì „ì²´ì ì¸ ë¡œì§ì€ context apië¥¼ ì‚¬ìš©í•œ ëª¨ë‹¬ ê´€ë¦¬ì™€ ë¹„ìŠ·í•˜ë©°, ë‹¬ë¼ì§„ ë¶€ë¶„ë§Œì„ ë‹¤ë¤˜ë‹¤.

í”„ë¡œì íŠ¸ì— ì´ë¯¸ redux ê´€ë ¨ ì…‹íŒ…ì´ ì™„ë£Œë˜ì—ˆë‹¤ëŠ” ê°€ì •í•˜ì— ì§„í–‰í•œë‹¤.

```
// store/index.js

import { combineReducers, configureStore } from "@reduxjs/toolkit";
import { modalSlice } from "./modalSlice";
...

const rootReducer = combineReducers({
...
  modal: modalSlice.reducer,
});

export const store = configureStore({
  reducer: rootReducer,
});
```

ë¨¼ì € `rootReducer` ì— ëª¨ë‹¬ reducerë¥¼ ì¶”ê°€í•´ì¤€ë‹¤.

```
// store/modalSlice.js

import { createSlice } from "@reduxjs/toolkit";

const initialState = {
  type: null,
  props: null,
};

export const modalSelector = (state) => state.modal;

export const modalSlice = createSlice({
  name: "modal",
  initialState,
  reducers: {
    openModal: (state, action) => {
      const { type, props } = action.payload;
      state.type = type;
      state.props = props;
    },
    closeModal: (state, action) => {
      return initialState;
    },
  },
});

export const { openModal, closeModal } = modalSlice.actions;
```

modalSliceë¥¼ ìƒì„±í•œ ë’¤,Â  `openModal` , `closeModal` ë¦¬ë“€ì„œ í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤.

```
// hooks/useModal.js

import { useDispatch } from "react-redux";
import { openModal, closeModal } from "../store/modalSlice";

function useModal() {
  const dispatch = useDispatch();

  const handleOpenModal = ({ type, props }) => {
    dispatch(openModal({ type, props }));
  };

  const handleCloseModal = (type) => {
    dispatch(closeModal());
  };

  return { openModal: handleOpenModal, closeModal: handleCloseModal };
}

export default useModal;
```

useModalì—ì„œëŠ” context api ì‚¬ìš© ì‹œ setterí•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ stateë¥¼ ë³€ê²½í–ˆë˜ ë¶€ë¶„ì„ `dispatch`ë¥¼ ì‚¬ìš©í•œ ì½”ë“œë¡œ ë°”ê¿”ì£¼ë©´ ëœë‹¤.

```
// components/ModalContainer.js

import React from "react";
import { createPortal } from "react-dom";
import { useSelector } from "react-redux";
import { modalSelector } from "../../store/modalSlice";
import SampleModal from "./SampleModal";
import SecondModal from "./SecondModal";

const MODAL_COMPONENTS = {
  first: SampleModal,
  second: SecondModal,
};

function ModalContainer() {
  const { type, props } = useSelector(modalSelector);

  if (!type) {
    return null;
  }

  const Modal = MODAL_COMPONENTS[type];
  return createPortal(
    <>
      <Modal {...props} />
    </>,
    document.getElementById("modal")
  );
}

export default ModalContainer;
```

ëª¨ë‹¬ì˜ typeê³¼ propsëŠ” `useSelector`ë¥¼ ì‚¬ìš©í•˜ì—¬ ê°€ì ¸ì˜¨ë‹¤. ì´í•˜ ì½”ë“œëŠ” ë™ì¼í•˜ë‹¤.

<br/>
<br/>

# ì—¬ëŸ¬ ê°œì˜ ëª¨ë‹¬ ë„ìš°ê¸°

í”„ë¡œì íŠ¸ë¥¼ ë§Œë“¤ë‹¤ ë³´ë©´ ê°€ë” ëª¨ë‹¬ ì•ˆì—ì„œ ë˜ ë‹¤ë¥¸ ëª¨ë‹¬ì„ í˜¸ì¶œí•  ì¼ì´ ìƒê¸´ë‹¤.
í•˜ì§€ë§Œ ìœ„ì—ì„œ ì†Œê°œí•œ ë°©ë²•ìœ¼ë¡œëŠ” ë‘ ê°œ ì´ìƒì˜ ëª¨ë‹¬ì„ ë„ìš¸ ìˆ˜ ì—†ë‹¤.

 <img
    src="https://blog.kakaocdn.net/dn/6nk9H/btrLNvHsOak/S1CtIoG1lzuNuoaatinI21/img.gif"
    width="612"
    className="m-auto"
  />

<br/>

ëª¨ë‹¬ ìƒíƒœ ê°’ìœ¼ë¡œ í•˜ë‚˜ì˜ ëª¨ë‹¬ ì •ë³´ë§Œì„ ì €ì¥í•˜ê¸° ë•Œë¬¸ì—, ë˜ ë‹¤ë¥¸ ëª¨ë‹¬ í˜¸ì¶œ ì‹œ ê¸°ì¡´ ëª¨ë‹¬ì´ ì‚¬ë¼ì§€ê³  ìƒˆë¡œìš´ ëª¨ë‹¬ì´ ë‚˜íƒ€ë‚œë‹¤.

ì—¬ëŸ¬ ê°œì˜ ëª¨ë‹¬ì„ ë„ìš°ê¸° ìœ„í•´ì„œëŠ” ëª¨ë‹¬ ìƒíƒœ ê°’ì„ ë°°ì—´ë¡œ ë³€ê²½í•˜ì—¬ ë Œë”ë§ í•  ëª¨ë‹¬ ì •ë³´ë¥¼ ì°¨ê³¡ì°¨ê³¡ ìŒ“ì•„ì£¼ì–´ì•¼ í•œë‹¤.

```
// store/modalSlice.js

import { createSlice } from "@reduxjs/toolkit";

const initialState = [];

export const modalSelector = (state) => state.modal;

export const modalSlice = createSlice({
  name: "modal",
  initialState,
  reducers: {
    openModal: (state, action) => {
      const { type, props } = action.payload;
      return state.concat({ type, props });
    },
    closeModal: (state, action) => {
      state.pop();
    },
  },
});

export const { openModal, closeModal } = modalSlice.actions;
```

`openModal` ì•¡ì…˜ì´ ë°œìƒí•˜ë©´ ëª¨ë‹¬ ë¦¬ìŠ¤íŠ¸ì— ìƒˆë¡œ ì—´ë¦° ëª¨ë‹¬ ì •ë³´ë¥¼ ë„£ì–´ì£¼ë„ë¡ ë°”ê¿”ì£¼ì—ˆë‹¤.

ë°˜ëŒ€ë¡œ `closeModal` ì•¡ì…˜ì´ ë°œìƒí•˜ë©´ ëª¨ë‹¬ ë¦¬ìŠ¤íŠ¸ì—ì„œ ê°€ì¥ ë§ˆì§€ë§‰ì— ì—´ë¦° ëª¨ë‹¬ ì •ë³´ë¥¼ `pop` í•´ì£¼ì—ˆë‹¤.

```
// components/ModalContainer.js

import React from "react";
import { createPortal } from "react-dom";
import { useSelector } from "react-redux";
import { modalSelector } from "../../store/modalSlice";
import SampleModal from "./SampleModal";
import SecondModal from "./SecondModal";

const MODAL_COMPONENTS = {
  first: SampleModal,
  second: SecondModal,
};

function ModalContainer() {
  const modalList = useSelector(modalSelector);

  const renderModal = modalList.map(({ type, props }) => {
    const ModalComponent = MODAL_COMPONENTS[type];
    return <ModalComponent key={type} {...props} />;
  });
  return createPortal(<>{renderModal}</>, document.getElementById("modal"));
}

export default ModalContainer;
```

`ModalContainer` ì—ì„œ ëª¨ë‹¬ ì»´í¬ë„ŒíŠ¸ë¥¼ ë Œë”ë§ í•˜ëŠ” ë¶€ë¶„ì„ ë°”ê¿”ì¤€ë‹¤.

 <img
    src="https://blog.kakaocdn.net/dn/b1yAbX/btrLMyLfuVH/sjsGWWrNnXP2hK2kvStjyK/img.gif"
    width="612"
    className="m-auto"
  />


ì´ì œ ì—¬ëŸ¬ ê°œì˜ ëª¨ë‹¬ì„ ë„ìš¸ ìˆ˜ ìˆë‹¤.

<br/>
<br/>

ì´ë²ˆ ê¸€ì€ ëª¨ë‹¬ì„ ì „ì—­ì ìœ¼ë¡œ ê´€ë¦¬í•˜ê¸° ìœ„í•´ â€˜ì–´ë–»ê²Œ êµ¬ì¡°ë¥¼ ì¡ì•„ì•¼ í•˜ëŠ”ì§€â€™ì— ì´ˆì ì„ ë§ì·„ìŠµë‹ˆë‹¤. ì½”ë“œ í•˜ë‚˜í•˜ë‚˜ì˜ ì„¤ëª…ì€ ìƒëµí–ˆê¸° ë•Œë¬¸ì— ë§Œì•½ ê¶ê¸ˆí•œ ë¶€ë¶„ì´ ìˆë‹¤ë©´ ëŒ“ê¸€ì„ ë‚¨ê²¨ì£¼ì„¸ìš”ğŸ™‚

<br/>
<br/>


# ì°¸ê³  ğŸ“Œ 

[stackoverflow: how can I display a Modal-dialog in redux that performs asynchronous actions](https://stackoverflow.com/questions/35623656/how-can-i-display-a-modal-dialog-in-redux-that-performs-asynchronous-actions/35641680)

Â [How can I display a modal dialog in Redux that performs asynchronous actions?](https://stackoverflow.com/questions/35623656/how-can-i-display-a-modal-dialog-in-redux-that-performs-asynchronous-actions/35641680)

[Practical Redux, Part 10: Managing Modals](https://blog.isquaredsoftware.com/2017/07/practical-redux-part-10-managing-modals/#adding-modal-dialogs)
